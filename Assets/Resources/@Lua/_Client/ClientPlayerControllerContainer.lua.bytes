local BaseClass = require("_Common.ModelContainer")
local _M = _MOE.class("ClientPlayerControllerContainer", BaseClass)

_M[".superctor"] = true -- 会调用父类方法

require("_Common.Net.DSMsgDefine")

-------------------------------- 外部调用 -------------------------------

local function RegisterPlayerController(self, LocalPlayerController) -- LocalPlayerController 是C# PlayerController
end

local function UnRegisterPlayerController(self, LocalPlayerController) -- LocalPlayerController 是C# PlayerController
    self:UnRegsterCSharpEvent(LocalPlayerController, "onClientStrEvent")
    self:UnRegisterPlayerEvents(LocalPlayerController, "onClientIntEvent")
    self:UnRegisterPlayerEvents(LocalPlayerController, "onClientInt2Event")
end

function _M:OnLoginDS()
    local PlayerController = _MOE.GameApp:GetLocalPlayerController()
    RegisterPlayerController(self, PlayerController)

    local userInfo = _MOE.Models.RootAttr:GetUserInfo()
    if userInfo and userInfo.token then
        PlayerController:DispatchServer_Reliable(_MOE.DS.ClientMsgIds.ClientLoginDS, userInfo.token) -- 发送Toekn给DS
    end
end

function _M:OnLoginOutDS()
    local PlayerController = _MOE.GameApp:GetLocalPlayerController()
    UnRegisterPlayerController(self, PlayerController)
end

-------------------------------------------------------------------------

return _M