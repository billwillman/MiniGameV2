----- Client的App
local BaseAppClass = require("_Common.BaseApp")

require("_Client.SceneEnum")

local _M = _MOE.class("ClientApp", BaseAppClass)

local function CreateUIRoot()
    local ret = _MOE.ResourceManager:CreateGameObjectAsync("Resources/UI/UI Root.prefab",
    function(process, isDone, root)
        if isDone then
            if root then
                root.name = "UI Root"
                root.transform:SetParent(_MOE.GameStartTransform, false)
            end
        end
    end
    )
    return ret
end

local function CreateMyPlayerInput()
    local ret = _MOE.ResourceManager:CreateGameObjectAsync("Resources/@Input/PlayerInput.prefab",
    function(process, isDone, playerInput)
        if isDone then
            if playerInput then
                playerInput.name = "PlayerInput"
                playerInput.transform:SetParent(_MOE.GameStartTransform, false)
            end
        end
    end
    )
    return ret
end

------------------------------ 继承方法 -------------------------------
function _M:OnInit()
    if CreateUIRoot() and CreateMyPlayerInput() then
        _MOE.BaseViewClass = require("_Client.BaseView")
        _MOE.UIManager = require("_Client.UIManager").New()
        -- 切换到登录场景（不一定有资源场景）
        _MOE.SceneManager:SwitchScene(_MOE.SceneEnum.LoginScene)
        --
    end
end

return _M