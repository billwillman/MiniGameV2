local _M = _MOE.class("UI_GM_DS", _MOE.BaseViewClass)

function _M:OnInit()
    self:AddButtonClick(self.bp.BtnReq, self.OnBtnClickReq)
    self:BindGSMsgNtf(_MOE.MsgIds.SM_DS_Info, self.OnMsgSMDSInfoNtf)
end

function _M:OnBtnClickReq()
    -- 请求申请DS
    _MOE.Models.NetModel:SendMsg(_MOE.MsgIds.CM_ReqDS, {sceneName = "MultiScene"})
end

function _M:OnMsgSMDSInfoNtf(msg)
    _MOE.Logger.Log("[SMDSInfoNtf] " .. _MOE.TableUtils.Serialize(msg))
    if msg.result == 0 then
        -- 没有报错，切换多人场景
        _MOE.TB = msg
        _MOE.SceneManager:SwitchScene(_MOE.SceneEnum.MultiScene)
    end
end

return _M